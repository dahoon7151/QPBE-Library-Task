{"openapi":"3.0.1","info":{"title":"QPBE - Library System","description":"QueryPie BE Task - Library Backend System","version":"1.0.0"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"security":[{"JWT":[]}],"paths":{"/api/users":{"get":{"tags":["User CRUD + JWT + Spring Security"],"summary":"모든 사용자 조회","description":"모든 사용자 정보를 리스트로 반환","operationId":"showUserList","responses":{"200":{"description":"사용자 목록 조회 성공","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDto"}}}}}}},"post":{"tags":["User CRUD + JWT + Spring Security"],"summary":"사용자 등록","description":"사용자이름, 비밀번호를 입력받고 사용자를 등록","operationId":"join","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}},"required":true},"responses":{"400":{"description":"이미 등록된 사용자 이름입니다.","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}},"201":{"description":"등록 성공","content":{"application/json":{}}}}}},"/api/users/token":{"post":{"tags":["User CRUD + JWT + Spring Security"],"summary":"사용자 로그인","description":"로그인 후 JWT 토큰 생성 및 반환","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}},"required":true},"responses":{"400":{"description":"잘못된 형식의 입력,사용자 이름은 공백일 수 없음비밀번호는 8자 이상, 숫자 및 특수문자(@$!%*?&#) 포함, 영어,숫자,특수문자만 가능","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JwtTokenDto"}}}},"201":{"description":"로그인 성공","content":{"application/json":{}}},"404":{"description":"존재하지 않는 사용자","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JwtTokenDto"}}}},"401":{"description":"비밀번호 틀림","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JwtTokenDto"}}}}}},"delete":{"tags":["User CRUD + JWT + Spring Security"],"summary":"로그아웃","description":"사용자의 토큰 제거, RefreshToken을 서버에서 관리하기 때문에 구현함","operationId":"logout","responses":{"401":{"description":"Unauthorized","content":{"*/*":{"schema":{"type":"string"}}}},"204":{"description":"로그아웃 성공","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/users/token/refresh":{"post":{"tags":["User CRUD + JWT + Spring Security"],"summary":"토큰 재발급","description":"AccessToken이 만료되었을 때, UX를 위해 RefreshToken 검증 후 토큰 재발급","operationId":"refreshToken","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JwtTokenDto"}}},"required":true},"responses":{"200":{"description":"재발급 성공","content":{"application/json":{}}},"401":{"description":"유효하지 않은 RefreshToken","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JwtTokenDto"}}}},"400":{"description":"토큰을 입력하세요","content":{"*/*":{"schema":{"$ref":"#/components/schemas/JwtTokenDto"}}}}}}},"/api/loans":{"post":{"tags":["Loan CRUD"],"summary":"도서 대출","description":"대출 테이블에 도서와 사용자에 대한 대출 정보를 저장","operationId":"loanBook","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoanDto"}}},"required":true},"responses":{"201":{"description":"도서 대출 성공","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoanDto"}}}},"400":{"description":"이미 대출 중인 도서","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoanDto"}}}},"404":{"description":"존재하지 않는 도서 또는 사용자","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoanDto"}}}}}}},"/api/books":{"get":{"tags":["Book CRUD"],"summary":"도서 목록 조회","description":"등록된 모든 도서를 페이지로 나누어 조회하고 제목 또는 출판일 기준으로 정렬합니다.","operationId":"showBookPage","parameters":[{"name":"page","in":"query","description":"페이지 번호","required":false,"schema":{"type":"integer","format":"int32","default":0},"example":1},{"name":"sort","in":"query","description":"정렬 기준","required":false,"schema":{"type":"string","default":"title"},"example":"date"}],"responses":{"200":{"description":"조회 성공, 없다면 빈 페이지 반환","content":{"application/json":{}}},"400":{"description":"잘못된 정렬기준","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageBookDto"}}}}}},"post":{"tags":["Book CRUD"],"summary":"도서 등록","description":"새로운 도서를 추가합니다.","operationId":"addBook","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookDto"}}},"required":true},"responses":{"400":{"description":"잘못된 데이터 입력","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}},"201":{"description":"등록 성공","content":{"application/json":{}}}}}},"/api/books/{id}/tag":{"post":{"tags":["Book CRUD"],"summary":"도서에 태그 추가","description":"도서에 태그를 한개 이상 추가합니다. 이미 추가된 태그는 추가하지 않습니다.","operationId":"addBookTags","parameters":[{"name":"id","in":"path","description":"도서 ID","required":true,"schema":{"minimum":1,"type":"integer","format":"int64"},"example":1},{"name":"tag","in":"query","description":"추가할 태그","required":true,"schema":{"type":"array","items":{"type":"string"}},"example":"소설"}],"responses":{"404":{"description":"해당 ID의 도서가 없음","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}},"400":{"description":"잘못된 데이터 입력","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}},"201":{"description":"태그 추가 성공","content":{"application/json":{}}}}}},"/api/loans/{id}":{"get":{"tags":["Loan CRUD"],"summary":"대출 여부 확인","description":"반납일을 체크하여 대출 여부를 조회합니다.","operationId":"checkLoan","parameters":[{"name":"id","in":"path","description":"도서 ID","required":true,"schema":{"minimum":1,"type":"integer","format":"int64"},"example":1}],"responses":{"200":{"description":"대출 여부 조회 성공","content":{"text/plain":{}}},"404":{"description":"존재하지 않는 도서","content":{"*/*":{"schema":{"type":"string"}}}}}},"patch":{"tags":["Loan CRUD"],"summary":"도서 반납","description":"도서 ID를 통해 반납되지 않은 대출 기록을 조회 후 반납 처리","operationId":"returnBook","parameters":[{"name":"id","in":"path","description":"도서 ID","required":true,"schema":{"minimum":1,"type":"integer","format":"int64"},"example":1}],"responses":{"404":{"description":"이미 반납된 도서","content":{"*/*":{"schema":{"type":"string"}}}},"200":{"description":"반납 성공","content":{"text/plain":{}}}}}},"/api/books/{id}":{"get":{"tags":["Book CRUD"],"summary":"특정 도서 조회","description":"도서 ID로 특정 도서 정보를 조회합니다.","operationId":"showBook","parameters":[{"name":"id","in":"path","description":"도서 ID","required":true,"schema":{"minimum":1,"type":"integer","format":"int64"},"example":1}],"responses":{"404":{"description":"해당 ID의 도서가 없음","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}},"200":{"description":"조회 성공","content":{"application/json":{}}},"400":{"description":"도서 ID는 0보다 큽니다","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}}}},"delete":{"tags":["Book CRUD"],"summary":"도서 삭제","description":"특정 도서 정보를 삭제합니다.","operationId":"deleteBook","parameters":[{"name":"id","in":"path","description":"도서 ID","required":true,"schema":{"minimum":1,"type":"integer","format":"int64"},"example":1}],"responses":{"404":{"description":"해당 ID의 도서가 없음","content":{"*/*":{"schema":{"type":"string"}}}},"204":{"description":"삭제 성공","content":{"*/*":{"schema":{"type":"string"}}}},"400":{"description":"잘못된 데이터 입력","content":{"*/*":{"schema":{"type":"string"}}}}}},"patch":{"tags":["Book CRUD"],"summary":"도서 수정","description":"특정 도서의 정보를 수정합니다.","operationId":"updateBook","parameters":[{"name":"id","in":"path","description":"도서 ID","required":true,"schema":{"minimum":1,"type":"integer","format":"int64"},"example":1}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookDto"}}},"required":true},"responses":{"404":{"description":"해당 ID의 도서가 없음","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}},"200":{"description":"수정 성공","content":{"application/json":{}}},"400":{"description":"잘못된 데이터 입력","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}}}}},"/api/users/{id}":{"get":{"tags":["User CRUD + JWT + Spring Security"],"summary":"특정 사용자 조회","description":"Id로 사용자 정보 조회 후 반환","operationId":"showUser","parameters":[{"name":"id","in":"path","description":"사용자 ID","required":true,"schema":{"minimum":1,"type":"integer","format":"int64"},"example":1}],"responses":{"200":{"description":"조회 성공","content":{"application/json":{}}},"404":{"description":"해당 ID의 사용자가 없음","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDto"}}}}}}},"/api/books/title/{title}":{"get":{"tags":["Book CRUD"],"summary":"제목으로 도서 검색","description":"검색어가 제목에 포함된 도서 목록을 조회합니다.","operationId":"findBookByTitle","parameters":[{"name":"title","in":"path","description":"제목 검색어","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"조회 성공, 없다면 빈 리스트 반환","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookDto"}}}}},"400":{"description":"잘못된 데이터 입력","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookDto"}}}}}}}},"/api/books/tag":{"get":{"tags":["Book CRUD"],"summary":"태그별 도서 필터링","description":"선택한 태그별 도서를 필터링하여 조회합니다.","operationId":"searchBooksByTags","parameters":[{"name":"tag","in":"query","description":"추가할 태그","required":true,"schema":{"type":"array","items":{"type":"string"}},"example":"소설"}],"responses":{"201":{"description":"조회 성공","content":{"application/json":{}}},"404":{"description":"해당 ID의 도서가 없음","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookDto"}}}}}}}},"/api/books/author/{author}":{"get":{"tags":["Book CRUD"],"summary":"저자명으로 도서 검색","description":"검색어가 저자명에 포함된 도서 목록을 조회합니다.","operationId":"findBookByAuthor","parameters":[{"name":"author","in":"path","description":"저자명 검색어","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"조회 성공, 없다면 빈 리스트 반환","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookDto"}}}}},"400":{"description":"잘못된 데이터 입력","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookDto"}}}}}}}}},"components":{"schemas":{"UserDto":{"required":["password","username"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"username":{"maxLength":20,"minLength":2,"type":"string"},"password":{"pattern":"^(?=.*\\d)(?=.*[@$!%*?&#])[A-Za-z\\d@$!%*?&#]{8,}$","type":"string"}}},"JwtTokenDto":{"required":["refreshToken"],"type":"object","properties":{"grantType":{"type":"string"},"accessToken":{"type":"string"},"refreshToken":{"type":"string"}}},"LoanDto":{"required":["bookId","userId"],"type":"object","properties":{"bookId":{"minimum":1,"type":"integer","format":"int64"},"bookTitle":{"type":"string"},"userId":{"minimum":1,"type":"integer","format":"int64"},"username":{"type":"string"},"loanDate":{"type":"string","format":"date"},"returnDate":{"type":"string","format":"date"}}},"BookDto":{"required":["author","publishedDate","title"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"title":{"type":"string"},"author":{"type":"string"},"publishedDate":{"type":"string","format":"date"},"tagSet":{"uniqueItems":true,"type":"array","items":{"type":"string"}}}},"PageBookDto":{"type":"object","properties":{"totalPages":{"type":"integer","format":"int32"},"totalElements":{"type":"integer","format":"int64"},"size":{"type":"integer","format":"int32"},"content":{"type":"array","items":{"$ref":"#/components/schemas/BookDto"}},"number":{"type":"integer","format":"int32"},"sort":{"$ref":"#/components/schemas/SortObject"},"first":{"type":"boolean"},"last":{"type":"boolean"},"numberOfElements":{"type":"integer","format":"int32"},"pageable":{"$ref":"#/components/schemas/PageableObject"},"empty":{"type":"boolean"}}},"PageableObject":{"type":"object","properties":{"offset":{"type":"integer","format":"int64"},"sort":{"$ref":"#/components/schemas/SortObject"},"pageSize":{"type":"integer","format":"int32"},"pageNumber":{"type":"integer","format":"int32"},"unpaged":{"type":"boolean"},"paged":{"type":"boolean"}}},"SortObject":{"type":"object","properties":{"empty":{"type":"boolean"},"sorted":{"type":"boolean"},"unsorted":{"type":"boolean"}}}},"securitySchemes":{"JWT":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}}}